---
import "../styles/global.css";
import Input from "../components/form/input.astro";
import Layout from "../layouts/Layout.astro";
import { useTranslations } from '../i18n/ui';

export interface Props {
  lang?: 'es' | 'en';
}

const { lang = 'es' } = Astro.props;
const t = useTranslations(lang);
---

<Layout>
    <div class="h-screen flex flex-col bg-black p-10">
        <form id="wizard-form" class="w-full max-w-5xl mx-auto flex flex-col h-full justify-between" autocomplete="off">
            <h1 class="text-4xl md:text-5xl font-light text-white mb-6">
                {t('form.title')}
            </h1>

            <!-- Step 1 -->
            <div id="step-1" class="flex flex-col h-full">
                <p class="text-gray-300 mb-8 max-w-5xl text-lg font-extralight" set:html={t('form.subtitle')}></p>
                <div class="flex-1">
                    <div class="mb-6">
                        <span class="text-xl text-white underline underline-offset-4">{t('form.step1.title')}</span>
                    </div>
                    <p class="text-gray-300 mb-8 max-w-5xl text-lg font-extralight" set:html={t('form.step1.subtitle')}></p>
                    <div class="mb-4">
                        <Input
                            label=""
                            placeholder={t('form.name.placeholder')}
                            value=""
                            name="nombre"
                            data-input="nombre"
                        />
                        <div id="error-nombre" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-4">
                        <Input
                            label=""
                            placeholder={t('form.email.placeholder')}
                            value=""
                            name="email"
                            data-input="email"
                        />
                        <div id="error-email" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-4">
                        <Input
                            type="tel"
                            label=""
                            placeholder={t('form.phone.placeholder')}
                            value=""
                            countryCode="+506"
                            name="telefono"
                            data-input="telefono"
                        />
                        <div id="error-telefono" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                </div>
                <div class="flex justify-center btn-container pt-10">
                    <button
                        type="button"
                        id="btn-next"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        {t('form.continue')}
                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline w-5 h-5 ml-3 arrow-svg">
                            <path d="M16.7 9.50001L11.9 4.70001M16.7 9.50001L11.9 14.3M16.7 9.50001H1.69995" stroke="currentColor"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Step 2 -->
            <div id="step-2" class="hidden flex flex-col h-full">
                <p class="text-gray-300 mb-8 max-w-5xl text-lg font-extralight" set:html={t('form.subtitle')}></p>
                <div class="flex-1">
                    <div class="mb-6">
                        <span class="text-xl text-white underline underline-offset-4">{t('form.step2.title')}</span>
                    </div>
                    <p class="text-gray-300 mb-8 max-w-5xl text-lg font-extralight" set:html={t('form.step2.subtitle')}></p>

                    <div class="mb-4">
                        <Input
                            label=""
                            placeholder={t('form.company.placeholder')}
                            value=""
                            name="empresa"
                            data-input="empresa"
                        />
                        <div id="error-empresa" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-4">
                        <Input
                            label=""
                            placeholder={t('form.industry.placeholder')}
                            value=""
                            name="industria"
                            data-input="industria"
                        />
                        <div id="error-industria" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-4">
                        <Input
                            label=""
                            placeholder={t('form.employees.placeholder')}
                            value=""
                            name="empleados"
                            data-input="empleados"
                        />
                        <div id="error-empleados" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-4">
                        <Input
                            label=""
                            placeholder={t('form.position.placeholder')}
                            value=""
                            name="cargo_empresa"
                            data-input="cargo_empresa"
                        />
                        <div id="error-cargo_empresa" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-2">
                        <Input
                            label=""
                            placeholder={t('form.website.placeholder')}
                            value=""
                            name="website"
                            data-input="website"
                        />
                        <div id="error-website" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="text-sm text-gray-400">{t('form.website.optional')}</div>
                </div>
                <div class="flex justify-between btn-container pt-10">
                    <button
                        type="button"
                        id="btn-prev"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        <span class="mr-2">←</span> {t('form.previous')}
                    </button>
                    <button
                        type="button"
                        id="btn-next-2"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        {t('form.continue')}
                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline w-5 h-5 ml-3 arrow-svg">
                            <path d="M16.7 9.50001L11.9 4.70001M16.7 9.50001L11.9 14.3M16.7 9.50001H1.69995" stroke="currentColor"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Step 3 -->
            <div id="step-3" class="hidden flex flex-col h-full">
                <p class="text-gray-300 mb-8 max-w-5xl text-lg font-extralight" set:html={t('form.subtitle')}></p>

                <div class="flex-1">
                    <div class="mb-6">
                        <span class="text-xl text-white underline underline-offset-4">{t('form.step3.title')}</span>
                    </div>
                    <div class="text-gray-300 text-sm mb-6 max-w-5xl font-extralight">
                        {t('form.investment.description')}
                    </div>
                    <p class="text-white mb-5 max-w-5xl text-sm" set:html={t('form.investment.question')}></p>
                    <div class="flex flex-col gap-4">
                        <label class="flex items-center gap-3 text-gray-400 cursor-pointer font-extralight">
                            <input type="radio" name="inversion" value="<36k" class="custom-radio mr-5" data-input="inversion" />
                            <span>{t('form.investment.less36k')}</span>
                        </label>
                        <label class="flex items-center gap-3 text-gray-400 cursor-pointer font-extralight">
                            <input type="radio" name="inversion" value="36k-60k" class="custom-radio mr-5" data-input="inversion" />
                            <span>{t('form.investment.36k60k')}</span>
                        </label>
                        <label class="flex items-center gap-3 text-gray-400 cursor-pointer font-extralight">
                            <input type="radio" name="inversion" value="60k-96k" class="custom-radio mr-5" data-input="inversion" />
                            <span>{t('form.investment.60k96k')}</span>
                        </label>
                        <label class="flex items-center gap-3 text-gray-400 cursor-pointer font-extralight">
                            <input type="radio" name="inversion" value="96k-144k" class="custom-radio mr-5" data-input="inversion" />
                            <span>{t('form.investment.96k144k')}</span>
                        </label>
                        <label class="flex items-center gap-3 text-gray-400 cursor-pointer font-extralight">
                            <input type="radio" name="inversion" value="144k-240k" class="custom-radio mr-5" data-input="inversion" />
                            <span>{t('form.investment.144k240k')}</span>
                        </label>
                        <label class="flex items-center gap-3 text-gray-400 cursor-pointer font-extralight">
                            <input type="radio" name="inversion" value=">240k" class="custom-radio mr-5" data-input="inversion" />
                            <span>{t('form.investment.more240k')}</span>
                        </label>
                    </div>
                    <div id="error-inversion" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span></span>
                    </div>
                </div>
                <div class="flex justify-between btn-container pt-10">
                    <button
                        type="button"
                        id="btn-prev-3"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        <span class="mr-2">←</span> {t('form.previous')}
                    </button>
                    <button
                        type="submit"
                        id="btn-submit"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        {t('form.continue')}
                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline w-5 h-5 ml-3 arrow-svg">
                            <path d="M16.7 9.50001L11.9 4.70001M16.7 9.50001L11.9 14.3M16.7 9.50001H1.69995" stroke="currentColor"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Step 4 -->
            <div id="step-4" class="hidden flex flex-col h-full">
                <p class="text-gray-300 mb-8 max-w-5xl text-lg font-extralight" set:html={t('form.subtitle')}></p>

                <div class="flex-1">
                    <div class="mb-6">
                        <span class="text-xl text-white underline underline-offset-4">{t('form.step4.title')}</span>
                    </div>
                    <div class="text-gray-300 text-md font-extralight mb-6 max-w-5xl">
                        {t('form.digitalization.description')}
                    </div>
                    <div class="mb-8">
                        <div class="text-white mb-2 text-gray-400 text-lg font-extralight">{t('form.challenge.question')}</div>
                        <div class="relative">
                            <textarea maxlength="200" rows="3" name="desafio" data-input="desafio" class="w-full bg-transparent border-b border-gray-400 text-white px-0 py-2 resize-none focus:outline-none focus:border-white placeholder-gray-400"></textarea>
                            <span class="absolute right-0 bottom-0 text-gray-400 text-xs">//</span>
                        </div>
                        <div class="text-xs text-gray-400 mt-1"><span id="count-desafio">0</span>/200</div>
                        <div id="error-desafio" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-8">
                        <div class="text-white mb-2 text-gray-400 text-lg font-extralight">{t('form.tools.question')}</div>
                        <div class="relative">
                            <textarea maxlength="200" rows="3" name="herramientas" data-input="herramientas" class="w-full bg-transparent border-b border-gray-400 text-white px-0 py-2 resize-none focus:outline-none focus:border-white placeholder-gray-400"></textarea>
                            <span class="absolute right-0 bottom-0 text-gray-400 text-xs">//</span>
                        </div>
                        <div class="text-xs text-gray-400 mt-1"><span id="count-herramientas">0</span>/200</div>
                        <div id="error-herramientas" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-8">
                        <div class="text-white mb-2 text-gray-400 text-lg font-extralight">{t('form.automate.question')}</div>
                        <div class="relative">
                            <textarea maxlength="200" rows="3" name="automatizar" data-input="automatizar" class="w-full bg-transparent border-b border-gray-400 text-white px-0 py-2 resize-none focus:outline-none focus:border-white placeholder-gray-400"></textarea>
                            <span class="absolute right-0 bottom-0 text-gray-400 text-xs">//</span>
                        </div>
                        <div class="text-xs text-gray-400 mt-1"><span id="count-automatizar">0</span>/200</div>
                        <div id="error-automatizar" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                </div>
                <div class="flex justify-between btn-container py-10">
                    <button
                        type="button"
                        id="btn-prev-4"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        <span class="mr-2">←</span> {t('form.previous')}
                    </button>
                    <button
                        type="submit"
                        id="btn-submit-4"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        {t('form.continue')}
                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline w-5 h-5 ml-3 arrow-svg">
                            <path d="M16.7 9.50001L11.9 4.70001M16.7 9.50001L11.9 14.3M16.7 9.50001H1.69995" stroke="currentColor"/>
                        </svg>
                    </button>
                </div>
            </div>
           
            <!-- Step 5 -->
            <div id="step-5" class="hidden flex flex-col h-full">
                <p class="text-gray-300 mb-8 max-w-5xl text-lg font-extralight" set:html={t('form.subtitle')}></p>

                <div class="flex-1">
                    <div class="mb-6">
                        <span class="text-xl text-white underline underline-offset-4">{t('form.step5.title')}</span>
                    </div>
                    <div class="text-gray-300 text-md font-extralight mb-6 max-w-5xl">
                        {t('form.motivation.description')}
                    </div>
                    <div class="mb-8">
                        <div class="text-white mb-2 text-gray-400 text-lg font-extralight">{t('form.motivation.question')}</div>
                        <div class="relative">
                            <textarea maxlength="200" rows="3" name="motivacion" data-input="motivacion" class="w-full bg-transparent border-b border-gray-400 text-white px-0 py-2 resize-none focus:outline-none focus:border-white placeholder-gray-400"></textarea>
                            <span class="absolute right-0 bottom-0 text-gray-400 text-xs">//</span>
                        </div>
                        <div class="text-xs text-gray-400 mt-1"><span id="count-motivacion">0</span>/200</div>
                        <div id="error-motivacion" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                    <div class="mb-8">
                        <div class="text-white mb-2 text-gray-400 text-lg font-extralight">{t('form.motivation.question2')}</div>
                        <div class="relative">
                            <textarea maxlength="200" rows="3" name="motivacion2" data-input="motivacion2" class="w-full bg-transparent border-b border-gray-400 text-white px-0 py-2 resize-none focus:outline-none focus:border-white placeholder-gray-400"></textarea>
                            <span class="absolute right-0 bottom-0 text-gray-400 text-xs">//</span>
                        </div>
                        <div class="text-xs text-gray-400 mt-1"><span id="count-motivacion2">0</span>/200</div>
                        <div id="error-motivacion2" class="text-red-500 text-sm mt-2 font-extralight hidden flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5.33333V8M8 10.6667H8.00667M2 8C2 8.78793 2.15519 9.56815 2.45672 10.2961C2.75825 11.0241 3.20021 11.6855 3.75736 12.2426C4.31451 12.7998 4.97595 13.2417 5.7039 13.5433C6.43185 13.8448 7.21207 14 8 14C8.78793 14 9.56815 13.8448 10.2961 13.5433C11.0241 13.2417 11.6855 12.7998 12.2426 12.2426C12.7998 11.6855 13.2417 11.0241 13.5433 10.2961C13.8448 9.56815 14 8.78793 14 8C14 6.4087 13.3679 4.88258 12.2426 3.75736C11.1174 2.63214 9.5913 2 8 2C6.4087 2 4.88258 2.63214 3.75736 3.75736C2.63214 4.88258 2 6.4087 2 8Z" stroke="#ED8296" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span></span>
                        </div>
                    </div>
                </div>
                <div class="flex justify-between btn-container py-10">
                    <button
                        type="button"
                        id="btn-prev-5"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        <span class="mr-2">←</span> {t('form.previous')}
                    </button>
                    <button
                        type="submit"
                        id="btn-submit-final"
                        class="flex items-center gap-2 border border-white rounded-full px-6 sm:px-8 py-2 text-white hover:bg-white hover:text-[#191B1C] active:bg-[#191B1C] active:text-white transition text-sm sm:text-base"
                    >
                        {t('form.send')}
                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline w-5 h-5 ml-3 arrow-svg">
                            <path d="M16.7 9.50001L11.9 4.70001M16.7 9.50001L11.9 14.3M16.7 9.50001H1.69995" stroke="currentColor"/>
                        </svg>
                    </button>
                </div>
            </div>
        </form>
    </div>
</Layout>

<script>
    const step1 = document.getElementById("step-1") as HTMLElement;
    const step2 = document.getElementById("step-2") as HTMLElement;
    const step3 = document.getElementById("step-3") as HTMLElement;
    const step4 = document.getElementById("step-4") as HTMLElement;
    const step5 = document.getElementById("step-5") as HTMLElement;
    const btnNext = document.getElementById("btn-next") as HTMLElement;
    const btnPrev = document.getElementById("btn-prev") as HTMLElement;
    const btnPrev3 = document.getElementById("btn-prev-3") as HTMLElement;
    const btnPrev4 = document.getElementById("btn-prev-4") as HTMLElement;
    const btnPrev5 = document.getElementById("btn-prev-5") as HTMLElement;
    const form = document.getElementById("wizard-form") as HTMLElement;
    const btnNext2 = document.getElementById("btn-next-2") as HTMLElement;
    const btnNext3 = document.getElementById("btn-submit") as HTMLElement;
    const btnNext4 = document.getElementById("btn-submit-4") as HTMLElement;
    const btnNextFinal = document.getElementById("btn-submit-final") as HTMLElement;

    // Estado simple en JS
    const formData = {
        nombre: "",
        email: "",
        telefono: "",
        pais: "+506", // Cambiar a Costa Rica por defecto
        empresa: "",
        industria: "",
        empleados: "",
        cargo_empresa: "",
        website: "",
        inversion: "",
        desafio: "",
        herramientas: "",
        automatizar: "",
        motivacion: "",
        motivacion2: "",
    };

    // Funciones de validación
    function showError(fieldName: string, messageKey: string) {
        const errorElement = document.getElementById(`error-${fieldName}`);
        if (errorElement) {
            const spanElement = errorElement.querySelector('span');
            if (spanElement) {
                // Get the language from the URL or default to 'es'
                const lang = window.location.pathname.startsWith('/en') ? 'en' : 'es';
                const errorMessages: Record<string, Record<string, string>> = {
                    'es': {
                        'name.required': 'El nombre es obligatorio',
                        'name.min': 'El nombre debe tener al menos 2 caracteres',
                        'email.required': 'El correo electrónico es obligatorio',
                        'email.invalid': 'Ingresa un correo electrónico válido',
                        'phone.required': 'El número de teléfono es obligatorio',
                        'phone.invalid': 'Ingresa un número válido',
                        'company.required': 'El nombre de la empresa es obligatorio',
                        'industry.required': 'La industria es obligatoria',
                        'employees.required': 'El número de empleados es obligatorio',
                        'position.required': 'El cargo en la empresa es obligatorio',
                        'website.invalid': 'Ingresa una URL válida (debe comenzar con http:// o https://)',
                        'investment.required': 'Debes seleccionar un rango de inversión',
                        'challenge.required': 'Debes describir el mayor desafío que enfrentas',
                        'challenge.min': 'La descripción debe tener al menos 10 caracteres',
                        'tools.required': 'Debes describir las herramientas digitales que utilizas',
                        'tools.min': 'La descripción debe tener al menos 10 caracteres',
                        'automate.required': 'Debes describir qué tarea te gustaría automatizar',
                        'automate.min': 'La descripción debe tener al menos 10 caracteres',
                        'motivation.required': 'Debes describir tu motivación para la transformación digital',
                        'motivation.min': 'La descripción debe tener al menos 10 caracteres',
                        'motivation2.required': 'Debes describir el problema que querés resolver o la oportunidad que querés capturar',
                        'motivation2.min': 'La descripción debe tener al menos 10 caracteres'
                    },
                    'en': {
                        'name.required': 'Name is required',
                        'name.min': 'Name must have at least 2 characters',
                        'email.required': 'Email address is required',
                        'email.invalid': 'Please enter a valid email address',
                        'phone.required': 'Phone number is required',
                        'phone.invalid': 'Please enter a valid number',
                        'company.required': 'Company name is required',
                        'industry.required': 'Industry is required',
                        'employees.required': 'Number of employees is required',
                        'position.required': 'Position in the company is required',
                        'website.invalid': 'Please enter a valid URL (must start with http:// or https://)',
                        'investment.required': 'You must select an investment range',
                        'challenge.required': 'You must describe the biggest challenge you face',
                        'challenge.min': 'Description must have at least 10 characters',
                        'tools.required': 'You must describe the digital tools you use',
                        'tools.min': 'Description must have at least 10 characters',
                        'automate.required': 'You must describe what task you would like to automate',
                        'automate.min': 'Description must have at least 10 characters',
                        'motivation.required': 'You must describe your motivation for digital transformation',
                        'motivation.min': 'Description must have at least 10 characters',
                        'motivation2.required': 'You must describe the problem you want to solve or the opportunity you want to capture',
                        'motivation2.min': 'Description must have at least 10 characters'
                    }
                };
                spanElement.textContent = (errorMessages[lang] as any)[messageKey] || messageKey;
            }
            errorElement.classList.remove('hidden');
        }
        
        // Agregar borde rojo al input
        const inputElement = document.querySelector(`[data-input="${fieldName}"]`) as HTMLElement;
        if (inputElement) {
            const inputContainer = inputElement.closest('.flex.items-center.border-b');
            if (inputContainer) {
                inputContainer.classList.remove('border-gray-400', 'focus-within:border-white');
                inputContainer.classList.add('border-red-500', 'focus-within:border-red-500');
            }
        }
        
        // Para textareas
        const textareaElement = document.querySelector(`textarea[data-input="${fieldName}"]`) as HTMLTextAreaElement;
        if (textareaElement) {
            textareaElement.classList.remove('border-gray-400', 'focus:border-white');
            textareaElement.classList.add('border-red-500', 'focus:border-red-500');
        }
    }

    function hideError(fieldName: string) {
        const errorElement = document.getElementById(`error-${fieldName}`);
        if (errorElement) {
            errorElement.classList.add('hidden');
        }
        
        // Remover borde rojo del input
        const inputElement = document.querySelector(`[data-input="${fieldName}"]`) as HTMLElement;
        if (inputElement) {
            const inputContainer = inputElement.closest('.flex.items-center.border-b');
            if (inputContainer) {
                inputContainer.classList.remove('border-red-500', 'focus-within:border-red-500');
                inputContainer.classList.add('border-gray-400', 'focus-within:border-white');
            }
        }
        
        // Para textareas
        const textareaElement = document.querySelector(`textarea[data-input="${fieldName}"]`) as HTMLTextAreaElement;
        if (textareaElement) {
            textareaElement.classList.remove('border-red-500', 'focus:border-red-500');
            textareaElement.classList.add('border-gray-400', 'focus:border-white');
        }
    }

    function validateEmail(email: string): boolean {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }

    // Información de validación de teléfonos por país
    const phoneValidationInfo = {
        cr: { // Costa Rica
            pattern: /^[2-9]\d{7}$/,
            placeholder: "81234567",
            example: "81234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        us: { // Estados Unidos
            pattern: /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,
            placeholder: "(555) 123-4567",
            example: "5551234567",
            description: "10 dígitos"
        },
        mx: { // México
            pattern: /^[1-9]\d{9}$/,
            placeholder: "5512345678",
            example: "5512345678",
            description: "10 dígitos, comenzando con 1-9"
        },
        es: { // España
            pattern: /^[6-9]\d{8}$/,
            placeholder: "612345678",
            example: "612345678",
            description: "9 dígitos, comenzando con 6-9"
        },
        ar: { // Argentina
            pattern: /^[1-9]\d{9}$/,
            placeholder: "1123456789",
            example: "1123456789",
            description: "10 dígitos, comenzando con 1-9"
        },
        br: { // Brasil
            pattern: /^[1-9]{2}[0-9]{8,9}$/,
            placeholder: "11987654321",
            example: "11987654321",
            description: "10-11 dígitos"
        },
        co: { // Colombia
            pattern: /^[1-9]\d{9}$/,
            placeholder: "3001234567",
            example: "3001234567",
            description: "10 dígitos, comenzando con 1-9"
        },
        pe: { // Perú
            pattern: /^[1-9]\d{8}$/,
            placeholder: "912345678",
            example: "912345678",
            description: "9 dígitos, comenzando con 1-9"
        },
        cl: { // Chile
            pattern: /^[2-9]\d{8}$/,
            placeholder: "912345678",
            example: "912345678",
            description: "9 dígitos, comenzando con 2-9"
        },
        uy: { // Uruguay
            pattern: /^[2-9]\d{7}$/,
            placeholder: "91234567",
            example: "91234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        py: { // Paraguay
            pattern: /^[2-9]\d{7}$/,
            placeholder: "91234567",
            example: "91234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        bo: { // Bolivia
            pattern: /^[2-9]\d{7}$/,
            placeholder: "71234567",
            example: "71234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        ec: { // Ecuador
            pattern: /^[2-9]\d{7}$/,
            placeholder: "91234567",
            example: "91234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        ve: { // Venezuela
            pattern: /^[2-9]\d{9}$/,
            placeholder: "4121234567",
            example: "4121234567",
            description: "10 dígitos, comenzando con 2-9"
        },
        pa: { // Panamá
            pattern: /^[2-9]\d{7}$/,
            placeholder: "61234567",
            example: "61234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        ni: { // Nicaragua
            pattern: /^[2-9]\d{7}$/,
            placeholder: "81234567",
            example: "81234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        hn: { // Honduras
            pattern: /^[2-9]\d{7}$/,
            placeholder: "91234567",
            example: "91234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        sv: { // El Salvador
            pattern: /^[2-9]\d{7}$/,
            placeholder: "71234567",
            example: "71234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        gt: { // Guatemala
            pattern: /^[2-9]\d{7}$/,
            placeholder: "51234567",
            example: "51234567",
            description: "8 dígitos, comenzando con 2-9"
        },
        bz: { // Belice
            pattern: /^[2-9]\d{6}$/,
            placeholder: "6123456",
            example: "6123456",
            description: "7 dígitos, comenzando con 2-9"
        }
    };

    // Función para obtener información de validación por código ISO
    function getPhoneValidationInfo(iso2: string) {
        return phoneValidationInfo[iso2 as keyof typeof phoneValidationInfo] || {
            pattern: /^\+?[\d\s\-\(\)]{7,}$/,
            placeholder: "Número de teléfono",
            example: "123456789",
            description: "Número de teléfono válido"
        };
    }

    // Función para obtener código ISO del país desde el código de marcación
    function getCountryIsoFromDialCode(dialCode: string): string {
        const countryMap: { [key: string]: string } = {
            '+506': 'cr', // Costa Rica
            '+1': 'us',   // Estados Unidos
            '+52': 'mx',  // México
            '+34': 'es',  // España
            '+54': 'ar',  // Argentina
            '+55': 'br',  // Brasil
            '+57': 'co',  // Colombia
            '+51': 'pe',  // Perú
            '+56': 'cl',  // Chile
            '+598': 'uy', // Uruguay
            '+595': 'py', // Paraguay
            '+591': 'bo', // Bolivia
            '+593': 'ec', // Ecuador
            '+58': 've',  // Venezuela
            '+507': 'pa', // Panamá
            '+505': 'ni', // Nicaragua
            '+504': 'hn', // Honduras
            '+503': 'sv', // El Salvador
            '+502': 'gt', // Guatemala
            '+501': 'bz'  // Belice
        };
        return countryMap[dialCode] || 'us';
    }

    function validatePhone(phone: string): boolean {
        const countryIso = getCountryIsoFromDialCode(formData.pais);
        const validationInfo = getPhoneValidationInfo(countryIso);
        return validationInfo.pattern.test(phone);
    }

    function validateWebsite(website: string): boolean {
        if (!website) return true; // Website es opcional
        const websiteRegex = /^https?:\/\/.+/;
        return websiteRegex.test(website);
    }

    function validateStep1(): boolean {
        let isValid = true;
        
        // Validar nombre
        if (!formData.nombre.trim()) {
            showError('nombre', 'name.required');
            isValid = false;
        } else if (formData.nombre.trim().length < 2) {
            showError('nombre', 'name.min');
            isValid = false;
        } else {
            hideError('nombre');
        }

        // Validar email
        if (!formData.email.trim()) {
            showError('email', 'email.required');
            isValid = false;
        } else if (!validateEmail(formData.email)) {
            showError('email', 'email.invalid');
            isValid = false;
        } else {
            hideError('email');
        }

        // Validar teléfono
        if (!formData.telefono.trim()) {
            showError('telefono', 'phone.required');
            isValid = false;
        } else if (!validatePhone(formData.telefono)) {
            showError('telefono', 'phone.invalid');
            isValid = false;
        } else {
            hideError('telefono');
        }

        return isValid;
    }

    function validateStep2(): boolean {
        let isValid = true;
        
        // Validar empresa
        if (!formData.empresa.trim()) {
            showError('empresa', 'company.required');
            isValid = false;
        } else {
            hideError('empresa');
        }

        // Validar industria
        if (!formData.industria.trim()) {
            showError('industria', 'industry.required');
            isValid = false;
        } else {
            hideError('industria');
        }

        // Validar empleados
        if (!formData.empleados.trim()) {
            showError('empleados', 'employees.required');
            isValid = false;
        } else {
            hideError('empleados');
        }

        // Validar cargo empresa
        if (!formData.cargo_empresa.trim()) {
            showError('cargo_empresa', 'position.required');
            isValid = false;
        } else {
            hideError('cargo_empresa');
        }

        // Validar website (opcional)
        if (formData.website && !validateWebsite(formData.website)) {
            showError('website', 'website.invalid');
            isValid = false;
        } else {
            hideError('website');
        }

        return isValid;
    }

    function validateStep3(): boolean {
        if (!formData.inversion) {
            showError('inversion', 'investment.required');
            return false;
        } else {
            hideError('inversion');
            return true;
        }
    }

    function validateStep4(): boolean {
        let isValid = true;
        
        // Validar desafío
        if (!formData.desafio.trim()) {
            showError('desafio', 'challenge.required');
            isValid = false;
        } else if (formData.desafio.trim().length < 10) {
            showError('desafio', 'challenge.min');
            isValid = false;
        } else {
            hideError('desafio');
        }

        // Validar herramientas
        if (!formData.herramientas.trim()) {
            showError('herramientas', 'tools.required');
            isValid = false;
        } else if (formData.herramientas.trim().length < 10) {
            showError('herramientas', 'tools.min');
            isValid = false;
        } else {
            hideError('herramientas');
        }

        // Validar automatizar
        if (!formData.automatizar.trim()) {
            showError('automatizar', 'automate.required');
            isValid = false;
        } else if (formData.automatizar.trim().length < 10) {
            showError('automatizar', 'automate.min');
            isValid = false;
        } else {
            hideError('automatizar');
        }

        return isValid;
    }

    function validateStep5(): boolean {
        let isValid = true;

        // Validar motivacion
        if (!formData.motivacion.trim()) {
            showError('motivacion', 'motivation.required');
            isValid = false;
        } else if (formData.motivacion.trim().length < 10) {
            showError('motivacion', 'motivation.min');
            isValid = false;
        } else {
            hideError('motivacion');
        }

        // Validar motivacion2 
        if (!formData.motivacion2.trim()) {
            showError('motivacion2', 'motivation.required');
            isValid = false;
        } else if (formData.motivacion2.trim().length < 10) {
            showError('motivacion2', 'motivation.min');
            isValid = false;
        } else {
            hideError('motivacion2');
        }

        return isValid;
    }

    // Manejar eventos de input personalizados
    document.addEventListener('input-change', function(e: any) {
        const { value, name } = e.detail;
        formData[name as keyof typeof formData] = value;
        // Ocultar error cuando el usuario empiece a escribir
        hideError(name);
    });

    // Manejar eventos de cambio de país
    document.addEventListener('country-change', function(e: any) {
        const { value, name } = e.detail;
        if (name === 'telefono') {
            formData.pais = value;
        }
    });

    // Manejar eventos de radio buttons
    document.addEventListener('change', function(e: any) {
        const target = e.target as HTMLInputElement;
        if (target.type === 'radio' && target.name === 'inversion') {
            formData.inversion = target.value;
            hideError('inversion');
        }
    });

    // Contadores de caracteres para textareas
    const textareas = document.querySelectorAll('textarea[data-input]');
    textareas.forEach((textarea: any) => {
        const inputName = textarea.getAttribute('data-input');
        const counter = document.getElementById(`count-${inputName}`);
        
        if (counter) {
            // Actualizar contador inicial
            counter.textContent = textarea.value.length;
            
            // Evento para actualizar contador
            textarea.addEventListener('input', (e: any) => {
                const target = e.target as HTMLTextAreaElement;
                counter.textContent = target.value.length.toString();
                formData[inputName as keyof typeof formData] = target.value;
                // Ocultar error cuando el usuario empiece a escribir
                hideError(inputName);
            });
        }
    });

    // Wizard navigation con validación
    btnNext?.addEventListener("click", () => {
        if (validateStep1()) {
            step1?.classList.add("hidden");
            step2?.classList.remove("hidden");
        }
    });
    
    btnPrev?.addEventListener("click", () => {
        step2?.classList.add("hidden");
        step1?.classList.remove("hidden");
    });
    
    btnPrev3?.addEventListener("click", () => {
        step3?.classList.add("hidden");
        step2?.classList.remove("hidden");
    });
    
    btnPrev4?.addEventListener("click", () => {
        step4?.classList.add("hidden");
        step3?.classList.remove("hidden");
    });
    
    btnPrev5?.addEventListener("click", () => {
        step5?.classList.add("hidden");
        step4?.classList.remove("hidden");
    });
    
    btnNext2?.addEventListener("click", () => {
        if (validateStep2()) {
            step2?.classList.add("hidden");
            step3?.classList.remove("hidden");
        }
    });
    
    btnNext3?.addEventListener("click", (e) => {
        e.preventDefault();
        if (validateStep3()) {
            step3?.classList.add("hidden");
            step4?.classList.remove("hidden");
        }
    });
    
    btnNext4?.addEventListener("click", (e) => {
        e.preventDefault();
        if (validateStep4()) {
            step4?.classList.add("hidden");
            step5?.classList.remove("hidden");
        }
    });

    // URL del webhook de Make
    const MAKE_WEBHOOK_URL = 'https://hook.us1.make.com/ch0o1ng2r1i1657gcy5gkw24nfwpnwia';

    async function enviarDatosAMake(datos: any) {
        try {
            const response = await fetch(MAKE_WEBHOOK_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    fecha_hora: new Date().toISOString(),
                    nombre: datos.nombre,
                    email: datos.email,
                    telefono: datos.pais + ' ' + datos.telefono,
                    empresa: datos.empresa,
                    industria: datos.industria,
                    empleados: datos.empleados,
                    cargo: datos.cargo_empresa,
                    website: datos.website || 'No especificado',
                    inversion: datos.inversion,
                    desafio: datos.desafio,
                    herramientas: datos.herramientas,
                    automatizar: datos.automatizar,
                    motivacion: datos.motivacion,
                    motivacion2: datos.motivacion2
                })
            });

            if (response.ok) {
                console.log('✅ Datos enviados exitosamente a Google Sheets');
                return true;
            } else {
                console.error('❌ Error al enviar datos:', response.statusText);
                return false;
            }
        } catch (error) {
            console.error('❌ Error de conexión:', error);
            return false;
        }
    }

    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Validar el paso final
        if (validateStep5()) {
            // Deshabilitar botón para evitar envíos múltiples
            const submitBtn = document.getElementById('btn-submit-final') as HTMLButtonElement;
            if (submitBtn) {
                submitBtn.disabled = true;
                const lang = window.location.pathname.startsWith('/en') ? 'en' : 'es';
                const sendingText = lang === 'en' ? 'Sending...' : 'Enviando...';
                submitBtn.innerHTML = `${sendingText} <span class="ml-2">⏳</span>`;
            }

            // Mostrar datos en consola (opcional para debug)
            // console.log('=== ENVIANDO DATOS A GOOGLE SHEETS ===');
            // console.log('Datos del formulario:', formData);
            
            // Enviar datos a Make
            const exitoso = await enviarDatosAMake(formData);
            
            if (exitoso) {
                // Redirigir a página de agradecimiento
                const lang = window.location.pathname.startsWith('/en') ? 'en' : 'es';
                const thanksUrl = lang === 'en' ? '/en/gracias' : '/gracias';
                window.location.href = thanksUrl;
            } else {
                // Mostrar error y reactivar botón
                const lang = window.location.pathname.startsWith('/en') ? 'en' : 'es';
                const errorMessage = lang === 'en' ? '❌ There was an error sending the form. Please try again.' : '❌ Hubo un error al enviar el formulario. Por favor, inténtalo de nuevo.';
                const sendText = lang === 'en' ? 'Send' : 'Enviar';
                alert(errorMessage);
                if (submitBtn) {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = `${sendText} <span class="ml-2">→</span>`;
                }
            }
        }
    });

    // Función para ajustar el posicionamiento de los botones según el scroll
    function adjustButtonPosition() {
        const btnContainers = document.querySelectorAll('.btn-container');
        const hasScroll = document.documentElement.scrollHeight > document.documentElement.clientHeight;
        
        btnContainers.forEach(container => {
            if (hasScroll) {
                container.classList.add('mb-40');
            } else {
                container.classList.remove('mb-40');
            }
        });
    }

    // Ejecutar al cargar la página
    adjustButtonPosition();
    
    // Ejecutar cuando cambie el tamaño de la ventana
    window.addEventListener('resize', adjustButtonPosition);
    
    // Ejecutar cuando cambie el contenido (para detectar cambios en el scroll)
    const observer = new MutationObserver(adjustButtonPosition);
    observer.observe(document.body, { childList: true, subtree: true });
</script>

<style>
.arrow-svg {
  transition: color 0.2s, filter 0.2s;
}
button:hover .arrow-svg, a:hover .arrow-svg {
  /* No filter needed, color is controlled by currentColor */
}
</style>
